---
title: "Introduction to Interaction Models"
date: "`r Sys.Date()`"
output: 
  pdf_document:
    latex_engine: xelatex
    highlight: zenburn
    fig_width: 6
    fig_height: 6
    includes: 
      in_header: preamble.tex
      before_body: doc-prefix.tex
mainfont: "Sabon"
sansfont: "Futura"
monofont: Inconsolata    
urlcolor: "umn"
bibliography: epsy8251.bib
csl: apa-single-spaced.csl
---

```{r knitr_init, echo=FALSE, cache=FALSE, message=FALSE}
library(knitr)
library(kableExtra)
library(rmdformats)

## Global options
options(max.print="75")
opts_chunk$set(prompt=FALSE, comment=NA, message=FALSE, warning=FALSE, tidy=FALSE, fig.width=6, fig.height=6,
               fig.pos='H', fig.align='center')
opts_knit$set(width=85)
options(scipen=5)
```


# Preparation

In this set of notes, you will learn about interaction models. To do so, we will examine the question of whether there is a differential effect of bounday-spanning work by gender on guilt and distress related to competing work and family demands. To do so, we will use the *work-demands.csv* data (see the [data codebook](http://zief0002.github.io/epsy-8251/codebooks/work-demands.html)). To begin, we will load several libraries and import the data into an object called `work`. 

```{r preparation, warning=FALSE, message=FALSE}
# Load libraries
library(broom)
library(corrr)
library(educate)
library(gridExtra)
library(tidyverse)

# Read in data
work = read_csv(file = "~/Documents/github/epsy-8251/data/work-demands.csv")
head(work)
```



# Main-Effects Models

We will begin the analysis by exploring there is an effect of boundary-spanning work on feelings of guilt about home-life balance. We will also control for gender in examining this effect as previous literature has suggested that culturally, men and women "continue to encounter different role meanings and obligations associated with culturally embedded ideologies about work and family life" [@Glavin:2011, p. 46].


```{r}
# Fit models
lm.1 = lm(guilt ~ 1 + bound_span_work, data = work)
lm.2 = lm(guilt ~ 1 + bound_span_work + female, data = work)

# Coefficient-level output
tidy(lm.1)
tidy(lm.2)
```

Based on Model 1, there is a slightly negative relationship between boundary-spanning work and guilt in the sample ($B=-0.08$). However, there is too much uncertainty to suggest that this effect is more than 0 in the population ($p=0.246$). In Model 2, we find that females have more guilt than males, controlling for differences in boundary-spanning work ($B=0.52$, $p<.001$). After controlling for gender differences, the effect of boundary-spanning work on guilt in the sample has diminished to almost zero ($B=-0.003$, $p=0.958$).

Visually, we can display these effects by showing the fitted partial regression lines (from Model 2) for females and males.

```{r out.width='3.5in', fig.cap="Fitted regression lines showing model-predicted guilt as a function of boundary-spanning work for females (orange, solid line) and males (blue, dashed line)."}
ggplot(data = work, aes(x = bound_span_work, y = guilt)) +
  geom_point(alpha = 0) +
  theme_bw() +
  xlab("Amount of boundary-spanning work") +
  ylab("Predicted guilt") +
  geom_abline(intercept = 3.09, slope = -.003, linetype = "dashed", color = "darkblue") +
  geom_abline(intercept = (3.09 + 0.52), slope = -.003, linetype = "solid", color = "darkorange")
```

This display helps us see that the effect of boundary-spanning work (slopes of the lines) is THE SAME for both males and females, and is essentially 0. We also see that females report more guilt than males, and that this difference in guilt is THE SAME regardless of how much boundary-spanning work is experienced.

This type of model where the effect of a predictor is THE SAME for each level of another predictor is referred to as a **main-effects model**. All the models we have fitted in the course thus far have been main-effects models. 

# Interaction Models: Models that Evaluate Differential Effects

One important question for work-life researchers is whether the effect of boundary-spanning work on guilt is actually the same for males and females. Examining the raw data suggests that this might be the case. In the scatterplots below, the sample data suggests that the effect of boundary-spanning work on average guilt is negative for males and positive for females. In otherwords, increased amounts of boundary-spanning work is asscociated with less guilt for males and more guilt for females.


```{r fig.width=8, fig.height=6, out.width='4in', fig.cap="Fitted regression lines showing model-predicted guilt as a function of boundary-spanning work for males (left-panel) and females (right-panel)."}
ggplot(data = work, aes(x = bound_span_work, y = guilt, color = factor(female))) +
  geom_jitter() +
  geom_smooth(method = "lm", se = FALSE) +
  theme_bw() +
  xlab("Amount of boundary-spanning work") +
  ylab("Predicted guilt") +
  scale_color_manual(name = "", values = c("darkblue", "darkorange")) +
  facet_wrap(~female)
```

Differential effects of boundary-spanning work for males and females on guilt imply that the slopes of the regression lines for males and females are not equal (i.e., the lines are not parallel). This is in stark contrast to the main-effects model which implies parallel regression lines, or equal effects of boundary-spannig work for both genders. In statistical terms we describe differential effects as **interaction effects**. We would say there is an interaction effect between boundary-spanning work and gender on guilt.

## Testing for an Interaction Effect

The inferential question is whether the interaction effect that we are seeing in the sample data is "real", or whether it is an artifact of sampling error. To examine this we need a way to test whether the slopes of the two regression lines are equal.

To do this, we create another predictor that is the product of the two predictors we believe interact and include that product term in the regression model along with the original predictors we used to create it (i.e., also include the constituent main-effects). In our example, we multiply the dummy-coded female predictor by the boundary-spanning work predictor to create the interaction term. Then we fit a model that includes the dummy-coded female predictor, the boundary-spanning work predictor, and the newly created interaction term. 


```{r}
# Create interaction term
work = work %>%
  mutate(
    bound_work_female = bound_span_work * female
    )

# View data
head(work)
```

```{r}
# Fit interaction model
lm.3 = lm(guilt ~ 1 + bound_span_work + female + bound_work_female, data = work)
tidy(lm.3)
```

The fitted equation is:

$$
\hat{\mathrm{Guilt}}_i = 3.54 - 0.23(\mathrm{Boundary\mbox{-}spanning~work}_i) - 0.17(\mathrm{Female}_i) + 0.36(\mathrm{Boundary\mbox{-}spanning~work}_i)(\mathrm{Female}_i)
$$

If we substitute in the appropriate dummy-coding we can obtain the fitted equations for males and females.

**Male Fitted Equation**

$$
\begin{split}
\hat{\mathrm{Guilt}}_i &= 3.54 - 0.23(\mathrm{Boundary\mbox{-}spanning~work}_i) - 0.17(0) + 0.36(\mathrm{Boundary\mbox{-}spanning~work}_i)(0) \\
&= 3.54 - 0.23(\mathrm{Boundary\mbox{-}spanning~work}_i)
\end{split}
$$

**Female Fitted Equation**

$$
\begin{split}
\hat{\mathrm{Guilt}}_i &= 3.54 - 0.23(\mathrm{Boundary\mbox{-}spanning~work}_i) - 0.17(1) + 0.36(\mathrm{Boundary\mbox{-}spanning~work}_i)(1) \\
&= 3.54 - 0.23(\mathrm{Boundary\mbox{-}spanning~work}_i) - 0.17 + 0.36(\mathrm{Boundary\mbox{-}spanning~work}_i) \\
&= \bigg[3.54 - 0.17\bigg] + \bigg[-0.23 + 0.36\bigg](\mathrm{Boundary\mbox{-}spanning~work}_i) \\
&= 3.37 + 0.13(\mathrm{Boundary\mbox{-}spanning~work}_i)
\end{split}
$$

Notice that the inclusion of the interaction term allows the slopes in the two fitted equations to be different. Moreover, the female slope of $B=0.13$ is 0.36 units higher than the male slope of $B=-0.23$. This difference in slopes is expressed by the estimated coefficient for the interaction term.

The inferential test associated with the interaction term in the `tidy()` output evaluates the null hypothesis that:

$$
H_0: \beta_{\mathrm{Interaction}} = 0
$$

This is a test of whether the slopes for males and females are the same; if the interaction term is 0, then the slopes are the same in the population. In our example, the inferential results suggest that the empirical data is not very compatible with the hypothesis that the difference in slopes is 0; $t_{1038}=2.64$, $p=.009$. This suggests that the effect of boundary-spanning work on guilt for females is different than that for males.

## Mathematical Expression of the Interaction Model

In general, the interaction model (with two predictors) can be written as,

$$
\begin{split}
Y_i = \beta_0 + \beta_1(X_{1i}) &+ \beta_2(X_{2i}) + \beta_3\left(X_{1i}\right)\left(X_{2i}\right) + \epsilon_i, \quad \mathrm{where}\\
& \epsilon_i \overset{i.i.d.}{\sim} \mathcal{N}\big(0,\sigma^2_{\epsilon}\big)
\end{split}
$$


First notice that if $\beta_3$, the coefficient on the interaction term, is zero, this equation reduces to the equation for the main-effects model, namely

$$
\begin{split}
Y_i = \beta_0 &+ \beta_1(X_{1i}) + \beta_2(X_{2i}) + \epsilon_i, \quad \mathrm{where}\\
& \epsilon_i \overset{i.i.d.}{\sim} \mathcal{N}\big(0,\sigma^2_{\epsilon}\big)
\end{split}
$$

Because of this, in practice, if the observed data is compatible with the null hypothesis that the coefficient for the interaction term is zero, it is common to drop the interaction term from the model, and re-fit the model using the main-effects model.

To further understand the terms in the interaction model, we will write out the interaction model using the context of our example. (For ease of writing, we will drop the part of the model that specifies the model's assumptions.)

$$
\mathrm{Guilt}_i = \beta_0 + \beta_1(\mathrm{Boundary\mbox{-}spanning~work}_i) + \beta_2(\mathrm{Female}_i) + \beta_3(\mathrm{Boundary\mbox{-}spanning~work}_i)(\mathrm{Female}_i) + \epsilon_i
$$

Since the predictor $\mathrm{Female}_i$ is a dummy coded predictor (0 for males; 1 for females), we can use substitute those values into the model and write the regression model associated with males and that for females.

\newpage

**Regression Model for Males**

$$
\begin{split}
\mathrm{Guilt}_i &= \beta_0 + \beta_1(\mathrm{Boundary\mbox{-}spanning~work}_i) + \beta_2(0) + \beta_3(\mathrm{Boundary\mbox{-}spanning~work}_i)(0) + \epsilon_i \\
&= \beta_0 + \beta_1(\mathrm{Boundary\mbox{-}spanning~work}_i) + \epsilon_i \\
\end{split}
$$

**Regression Model for Females**

$$
\begin{split}
\mathrm{Guilt}_i &= \beta_0 + \beta_1(\mathrm{Boundary\mbox{-}spanning~work}_i) + \beta_2(1) + \beta_3(\mathrm{Boundary\mbox{-}spanning~work}_i)(1) + \epsilon_i \\
&= \beta_0 + \beta_1(\mathrm{Boundary\mbox{-}spanning~work}_i) + \beta_2 + \beta_3(\mathrm{Boundary\mbox{-}spanning~work}_i) + \epsilon_i \\
&= \bigg[\beta_0 + \beta_2\bigg] + \bigg[\beta_1 + \beta_3\bigg](\mathrm{Boundary\mbox{-}spanning~work}_i) + \epsilon_i \\
\end{split}
$$

We can use these equations to understand what each term in the interaction model represnts:

- The intercept term from the interaction model ($\beta_0$) turns out to be the intercept term for the reference group (males in our example). 
- The slope term associated with boundary-spanning work from the interaction model ($\beta_1$) turns out to be the effect of boundary-spanning work for the reference group (males in our example).
- The slope term associated with the dummy-coded female predictor from the interaction model ($\beta_2$) turns out to be the difference in intercept between the group coded 1 and the reference group (difference in the female and male intercepts in our example).
- The slope term associated with the interaction predictor from the interaction model ($\beta_3$) turns out to be the difference in slopes between the group coded 1 and the reference group (difference in the female and male slopes in our example).


## Interpreting the Fitted Model's Coefficients

Here we will use the interaction model we fitted earlier to understand how to interpret the different coefficients in the model. Recall that the fitted equation was,

$$
\hat{\mathrm{Guilt}}_i = 3.54 - 0.23(\mathrm{Boundary\mbox{-}spanning~work}_i) - 0.17(\mathrm{Female}_i) + 0.36(\mathrm{Boundary\mbox{-}spanning~work}_i)(\mathrm{Female}_i)
$$

- The intercept term ($\hat\beta_0=3.54$) indicates that males who never experience boundary-spanning work (boundary-spanning work = 0) have a guilt level of 3.54, on average. 
- The slope term associated with boundary-spanning work ($\hat\beta_1=-0.23$) indicates that, for males, each one-unit increase in boundary-spanning work is associated with a decrease in guilt level of 0.23, on average.
- The slope term associated with the dummy-coded female predictor ($\hat\beta_2=-0.17$) indicates that females who never experience boundary-spanning work (boundary-spanning work = 0) have a guilt level that is 0.17-units lower, on average, than males who never experience boundary-spanning work.
- The slope term associated with the interaction predictor ($\hat\beta_3=0.36$) indicates that, for females, the effect of boundary-spanning work on guilt is 0.36-units higher, on average, than the effect of boundary-spanning work on guilt for males. In other words, for females, each one-unit increase in boundary-spanning work is associated with an increase in guilt level of 0.13, on average.

In general, the easiest way to determine how to interpret the coefficients is to actually compute the partial regression equations for males and females based on the fitted interaction equation like we did earlier. Then you can just interpret the intercept and slope terms for males and females independently.

# Plotting the Fitted Equation for the Interaction Model

Almost always, plotting the fitted model is a good idea once you have fitted an interaction model. To do this we use `geom_abline()` to plot the male and female fitted lines.

```{r fig.width=6, fig.height=6, out.width='3.5in', fig.cap="Fitted regression lines showing model-predicted guilt as a function of boundary-spanning work for males (blue, dashed line) and females (orange, solid line)."}
ggplot(data = work, aes(x = bound_span_work, y = guilt)) +
  geom_point(alpha = 0) +
  theme_bw() +
  xlab("Amount of boundary-spanning work") +
  ylab("Predicted guilt") +
  geom_abline(intercept = 3.54, slope = -0.23, color = "darkblue", linetype = "dashed") +
  geom_abline(intercept = 3.37, slope = 0.13, color = "darkorange", linetype = "solid")
```

In this plot, we can see some of th same effects we interpreted from the coefficients:

- Females have a lower intercept than males,
- The effect of boundary-spanning work for males is negative, while that for females is positive.

The plot also allows us to see other things as well. For example,

- The lines cross at a boundary-spanning work value between 0 and 1. This implies that while females have less guilt than males, on average, when they do not experience boundary-spanning work, once boundary-spanning work is experienced, females have higher levels of guilt than their male counterparts, on average.

In the social sciences this change in who experiences more guilt (at some levels males and at other levels females) is referred to as a **disordinal interaction**. It is generally better to show the plot and describe the implications of this rather than just stating that the interaction was disordinal in nature.


# Adding Covariates into the Model

One important covariate for explaining the effect of boundary-spanning work on guilt is an employee's level of authority. Like the main-effects models we have previously fitted, we can also control for effects in the interaction model. Here we include level of authority in the model as a covariate to further examine whether there are differential effects of boundary-spanning work on guilt for males and females.

```{r}
# Fit interaction model
lm.4 = lm(guilt ~ 1 + authority + bound_span_work + female + bound_work_female, data = work)
tidy(lm.4)
```

The fitted equation is,

$$
\hat{\mathrm{Guilt}}_i = 3.84 - 0.16(\mathrm{Authority}_i) - 0.22(\mathrm{Boundary\mbox{-}spanning~work}_i) - 0.19(\mathrm{Female}_i) + 0.37(\mathrm{Boundary\mbox{-}spanning~work}_i)(\mathrm{Female}_i)
$$

- The intercept term ($\hat\beta_0=3.84$) indicates that males with no authority, who never experience boundary-spanning work (boundary-spanning work = 0), have a guilt level of 3.84, on average.
- The slope term associated with authority ($\hat\beta_1=-0.16$) indicates that, controlling for differences in gender and amount of boundary-spanning work, each one-unit increase in authority is associated with a decrease in guilt level of 0.16, on average.
- The slope term associated with boundary-spanning work ($\hat\beta_1=-0.22$) indicates that, for males, each one-unit increase in boundary-spanning work is associated with a decrease in guilt level of 0.22, on average, controlling for differences in level of authority.
- The slope term associated with the dummy-coded female predictor ($\hat\beta_2=-0.19$) indicates that females with no authority and who never experience boundary-spanning work (boundary-spanning work = 0) have a guilt level that is 0.19-units lower, on average, than males who never experience boundary-spanning work.
- The slope term associated with the interaction predictor ($\hat\beta_3=0.37$) indicates that, for females, the effect of boundary-spanning work on guilt is 0.37-units higher, on average, than the effect of boundary-spanning work on guilt for males, controlling for differences in authority level. In other words, for females, each one-unit increase in boundary-spanning work is associated with an increase in guilt level of 0.15, on average, controlling for differences in authority level.

To answer our question, the only term that matters here is the interaction term. The inferential results suggest that the after controlling for differences in authority level, there does seem to be a differential effect of boundary-spanning work for males and females. The empirical data are not very consistent with there being no differential effect of boundary-spanning work for males and females ($t_{1037}=2.69$. $p=0.007$).

We can also plot the results of the fitted model by substituting in values of authority and obtaining the partial fitted equations for males and females. For example, here we might use the values of 0 (no authority) and 4 (highest level of authority) to obtain two partial equations for males and two for females.

\newpage

**Fitted Equations for Males**

$$
\begin{split}
\mathbf{No~Authority:~}&\hat{\mathrm{Guilt}}_i = 3.84 - 0.22(\mathrm{Boundary\mbox{-}spanning~work}_i)\\
\mathbf{High~Authority:~}&\hat{\mathrm{Guilt}}_i = 3.20 - 0.22(\mathrm{Boundary\mbox{-}spanning~work}_i)\\
\end{split}
$$

**Fitted Equations for Females**

$$
\begin{split}
\mathbf{No~Authority:~}&\hat{\mathrm{Guilt}}_i = 3.65 + 0.15(\mathrm{Boundary\mbox{-}spanning~work}_i)\\
\mathbf{High~Authority:~}& 3.01 + 0.15(\mathrm{Boundary\mbox{-}spanning~work}_i)\\
\end{split}
$$

```{r fig.width=8, fig.height=4, out.width='5in', fig.cap="Fitted regression lines showing model-predicted guilt as a function of boundary-spanning work for males (blue lines) and females (orange lines). These effects are shown for employees with no authority (dashed lines) and those with the highest level of authority (solid lines)."}
p1 = ggplot(data = work, aes(x = bound_span_work, y = guilt)) +
  geom_point(alpha = 0) +
  theme_bw() +
  xlab("Amount of boundary-spanning work") +
  ylab("Predicted guilt") +
  geom_abline(intercept = 3.84, slope = -0.22, color = "darkblue", linetype = "dashed") +
  geom_abline(intercept = 3.65, slope = 0.15, color = "darkorange", linetype = "dashed") +
  ggtitle("No authority")

p2 = ggplot(data = work, aes(x = bound_span_work, y = guilt)) +
  geom_point(alpha = 0) +
  theme_bw() +
  xlab("Amount of boundary-spanning work") +
  ylab("Predicted guilt") +
  geom_abline(intercept = 3.20, slope = -0.22, color = "darkblue", linetype = "solid") +
  geom_abline(intercept = 3.01, slope = 0.15, color = "darkorange", linetype = "solid") +
  ggtitle("Highest level of authority")

grid.arrange(p1, p2, nrow = 1)
```



## Model Assumptions

Just like main-effects models, we need to examine the assumptions for any fitted interaction model. We do this in the exact same way we did for main effects models.

```{r out.width='3in', warning=FALSE, message=FALSE, fig.show='hold', cache=TRUE}
# Create augmented data
out.4 = augment(lm.4)


# Examine normality assumption
ggplot(data = out.4, aes(x = .std.resid)) +
  stat_watercolor_density(model = "normal") +
  stat_density(geom = "line") +
  theme_bw() +
  xlab("Standardized Residuals")

# Examine other assumptions
ggplot(data = out.4, aes(x = .fitted, y = .std.resid)) +
  geom_jitter() +
  geom_hline(yintercept = 0) +
  geom_hline(yintercept = c(-2, 2), linetype = "dotted") +
  theme_bw() +
  xlab("Fitted Values") +
  ylab("Standardized Residuals")
```

Based on the density plot of the standardized residuals, there is some question about whether the normality assumption is satisfied. The scatterplot of the model's standardized residuals versus its fitted values suggests that the assumption of homoskedasticity is questionable (the variation in the residuals seems to get larger for larger fitted values). The plot does suggest that the average residual is close to zero for each fitted value, indicating that the linearity assumption seems tenable.

\newpage

# Two Interpretations of an Interaction Effect

There are always two interpretations of an interaction effect.

1. The effect of $X_1$ on $Y$ differs depending on the level of $X_2$.
2. The effect of $X_2$ on $Y$ differs depending on the level of $X_1$.

For example, in our example, we interpreted the interaction as the effect of boundary-spanning work on guilt is different for males and females. In the visual display, this interpretation  focuses on the difference in slopes. We could also interpret the interaction as: the effect of gender on guilt is different depending on the amount of boundary-spanning work. In the visual display, this interpretation  focuses on the vertical distance between the lines.

```{r fig.width=6, fig.height=6, out.width='3.5in', fig.cap="Fitted regression lines showing model-predicted guilt as a function of boundary-spanning work for males (blue, dashed line) and females (orange, solid line).", echo=FALSE}
ggplot(data = work, aes(x = bound_span_work, y = guilt)) +
  geom_point(alpha = 0) +
  theme_bw() +
  xlab("Amount of boundary-spanning work") +
  ylab("Predicted guilt") +
  geom_abline(intercept = 3.54, slope = -0.23, color = "darkblue", linetype = "dashed") +
  geom_abline(intercept = 3.37, slope = 0.13, color = "darkorange", linetype = "solid")
```

Which interpretation you use is up to you. Try them both. Although they both describe the same interaction, trying the different interpretations can sometimes lead to more information about or more natural ways of describing the effects.


# Differential Effects of Boundary-Spanning Work on Distress by Gender?

A direct consequence of guilt is psychological distress. Here we examine whether there are differential effects of boundary-spanning work on psychological distress for males and females. As we did in the previous analysis, we will also control for differences in authority in this model.

```{r}
# Fit interaction model
lm.5 = lm(distress ~ 1 + authority + bound_span_work + female + bound_work_female, data = work)
tidy(lm.5)
```

The fitted equation is,

$$
\hat{\mathrm{Distress}}_i = 15.41 - 0.30(\mathrm{Authority}_i) - 0.70(\mathrm{Boundary\mbox{-}spanning~work}_i) - 0.34(\mathrm{Female}_i) + 1.35(\mathrm{Boundary\mbox{-}spanning~work}_i)(\mathrm{Female}_i)
$$

Looking at the inferential results associated with the interaction term, it seems that there is a statistical interaction between gender and boundary-spanning work on psychological distress after controlling for diiferences in authority ($t_{1037}=2.43$, $p=.002$). 

To better understand this interaction, we will plot the partial regression lines for males and females. We control authority by setting it to its median value of 2.0. 

**Fitted Equations**

$$
\begin{split}
\mathbf{Males:~}&\hat{\mathrm{Distress}}_i = 14.81 - 0.70(\mathrm{Boundary\mbox{-}spanning~work}_i)\\
\mathbf{Females:~}&\hat{\mathrm{Distress}}_i = 14.47 + 0.65(\mathrm{Boundary\mbox{-}spanning~work}_i)\\
\end{split}
$$



```{r fig.width=6, fig.height=6, out.width='3.5in', fig.cap="Fitted regression lines showing model-predicted guilt as a function of boundary-spanning work for males (blue, dashed lines) and females (orange.solid lines). Authority level has been controlled for by setting it to its median value."}
ggplot(data = work, aes(x = bound_span_work, y = distress)) +
  geom_point(alpha = 0) +
  theme_bw() +
  xlab("Amount of boundary-spanning work") +
  ylab("Predicted psychological distress") +
  geom_abline(intercept = 14.81, slope = -0.70, color = "darkblue", linetype = "dashed") +
  geom_abline(intercept = 14.47, slope = 0.65, color = "darkorange", linetype = "solid")
```


The effect of boundary-spanning work for males on psychological distress is negative; males experiencing more boundary-spanning work have less psychological distress on average (after controlling for differences in authority). For females, the effect is positive; females experiencing more boundary-spanning work have more psychological distress on average (after controlling for differences in authority).


## Model Assumptions

Examining the assumptions, we find that there is some question about whether the normality assumption is satisfied. The scatterplot of the model's standardized residuals versus its fitted values suggests that the assumption of homoskedasticity seems tenble (although there are a few observations with extreme values). The plot also suggests that the average residual is close to zero for each fitted value, indicating that the linearity assumption seems tenable.

```{r out.width='3in', warning=FALSE, message=FALSE, fig.show='hold', cache=TRUE}
# Create augmented data
out.5 = augment(lm.5)


# Examine normality assumption
ggplot(data = out.5, aes(x = .std.resid)) +
  stat_watercolor_density(model = "normal") +
  stat_density(geom = "line") +
  theme_bw() +
  xlab("Standardized Residuals")

# Examine other assumptions
ggplot(data = out.5, aes(x = .fitted, y = .std.resid)) +
  geom_jitter() +
  geom_hline(yintercept = 0) +
  geom_hline(yintercept = c(-3, 3), linetype = "dotted") +
  theme_bw() +
  xlab("Fitted Values") +
  ylab("Standardized Residuals")
```



# References

\setlength{\parindent}{-0.2in}
\setlength{\leftskip}{0.2in}
\setlength{\parskip}{8pt}
\noindent


