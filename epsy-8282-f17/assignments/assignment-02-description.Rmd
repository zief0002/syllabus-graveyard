---
title: "Assignment 2"
author: "EPsy 8282"
date: "Fall 2017"
header-includes:
   - \usepackage{mathspec}
   - \usepackage{xcolor}
   - \usepackage{booktabs}
   - \definecolor{umn}{RGB}{153, 0, 85}
   - \definecolor{umn2}{rgb}{0.1843137, 0.4509804, 0.5372549}
   - \definecolor{myorange}{HTML}{EA6153}
output: 
  pdf_document:
    highlight: tango
    latex_engine: xelatex
    fig_width: 6
    fig_height: 6
mainfont: "Bembo Std"
sansfont: "Helvetica Neue UltraLight"
monofont: Inconsolata
urlcolor: "umn2"
always_allow_html: yes
---

```{r setup, echo=FALSE, warning=FALSE, message=FALSE}
sleep = read.csv(file = "~/Dropbox/epsy-8282/data/sleep.csv")
library(tidyr)
library(dplyr)
library(ggplot2)
library(ggjoy)
```

Please submit your responses to each question in a printed document. Also, please adhere to the following guidelines for further formatting your assignment: 

- All graphics should be resized so that they do not take up more room than necessary and should have an appropriate **caption** and **labels**. 
- Any typed mathematics (equations, matrices, vectors, etc.) should be appropriately typeset within the document using Equation Editor, Markdown, or \LaTeX. 

This assignment is worth 17 points. Each question is worth 1 point unless otherwise noted. 

\rule{0.5\linewidth}{\linethickness}

For this assignment, you will use the file *sleep.csv*. This file contains data from 18 people who participated in a sleep deprivation study. On Day 0 the participants were allowed their normal amount of sleep. Each of the subsequent nine nights (Day 1 to Day 9), they were restricted to 3 hours of sleep per night. Each day the participants were given a series of reaction time tests and the average time (in milliseconds) was computed and recorded. The data consists of 13 variables, which are:

- `id`: Participant ID number
- `female`: Participant's sex (0 = male; 1 = female)
- `gpa`: Participant's gradepoint average (on a 4-pt scale)
- `reaction_0`: Average reaction time (in ms) after 0 days of sleep deprivation
- `reaction_1`: Average reaction time (in ms) after 1 day of sleep deprivation
- `reaction_2`: Average reaction time (in ms) after 2 days of sleep deprivation
- `reaction_3`: Average reaction time (in ms) after 3 days of sleep deprivation
- `reaction_4`: Average reaction time (in ms) after 4 days of sleep deprivation
- `reaction_5`: Average reaction time (in ms) after 5 days of sleep deprivation
- `reaction_6`: Average reaction time (in ms) after 6 days of sleep deprivation
- `reaction_7`: Average reaction time (in ms) after 7 days of sleep deprivation
- `reaction_8`: Average reaction time (in ms) after 8 days of sleep deprivation
- `reaction_9`: Average reaction time (in ms) after 9 days of sleep deprivation

Two participants (5 and 16) dropped out after the 7th measurement wave. 

The data come from: Belenky, G., Wesensten, N. J., Thorne, D. R., Thomas, M. L., Sing, H. C., Redmond, D. P., Russo, M. B. \& Balkin, T. J. (2003). Patterns of performance degradation and restoration during sleep restriction and subsequent recovery: A sleep dose-response study. *Journal of Sleep Research, 12*, 1--12.

\rule{0.5\linewidth}{\linethickness}

```{r eval=FALSE, echo=FALSE}
sleep_long = sleep %>% gather(day, reaction, reaction_0:reaction_9) %>% arrange(id) %>%
  mutate(day2 = as.numeric(as.factor(day))-1)

ggplot(data = sleep_long, aes(x = reaction, y = day)) +
  geom_joy() +
  theme_bw() +
  scale_y_discrete(name = "Day", labels = c("0", "1", "2", "3", "4", "5", "6", "7", "8", "9")) +
  xlab("Reaction time (in ms)") +
  coord_flip()

ggplot(data = sleep_long, aes(x = day, y = reaction)) +
  geom_boxplot() +
  theme_bw() +
  scale_x_discrete(name = "Day", labels = c("0", "1", "2", "3", "4", "5", "6", "7", "8", "9")) +
  ylab("Reaction time (in ms)")
```



\newpage
## Description

1. Create boxplots (or joy plots) of participants' reaction times over time. 

2. Describe the shape of the reaction time distributions across the ten measurement waves. (Use the descriptors: "symmetric", "positively skewed", or "negatively skewed".) 

3. Compute and report the mean reaction time for each measurement wave. Describe the longitudinal mean pattern. How does the mean reaction time change over the duration of the study?

4. Compute the variation in reaction times for each measurement wave. Describe the longitudinal pattern in variation. How does the variation in reaction times change over the duration of the study?

5. Compute and report the observed correlation matrix of the repeated measures (based on the 10 reaction time variables).


## Facet Plot of Individual Change Over Time

6. Create a plot of participants' observed response profiles (i.e., line plot). Create this plot so that `reaction_0` is positioned at the *y*-intercept (at Day = 0). Facet this plot on individuals so that each individual is in her/his own panel. Also include the fitted OLS regression line for each individual in her/his respective panel.

7. Does a linear change curve seem reasonable to describe the response profiles (pattern of change) for these 18 participants? Explain.

## Plot of the OLS Regression Lines

8. Assume we adopt a linear change curve. Create a plot of the 18 OLS regression lines. (Do not display the observed profiles; only display the regression lines.) Plot these lines on the same panel so that they can easily be compared.

9. Based on the plot you produced in Question 8, is there variability in participants' initial reaction time (i.e., intercept)? Explain.

10. Based on the plot you produced in Question 8, is there variability in participants' rate of change? Explain.


## Mean Change Over Time

11. Create a spaghetti plot displaying the observed response profiles for the 18 participants. Make these profiles somewhat transparent. Also plot the mean response profile. Make this profile completely opaque.

12. Based on the plot you produced in Question 11, describe the change pattern exhibited in the mean response profile. Is the change linear or nonlinear?


## Mean Change Over Time Conditioned on Sex

13. Create a plot that displays the observed mean response profile of participants' reaction times conditioned on sex. (On this plot, do not display the individual response profiles.) Display both profiles on the same panel, and use different colors and linetypes to differentiate the two profiles.

14. Based on the plot, briefly comment on any differences in the observed mean change pattern between males and females.

\newpage
## Mean Change Over Time Conditioned on Sex by GPA Interaction

Suppose we anticipate an interaction between sex and GPA. Create a categorical variable from the quantitative GPA variable that discretizes the GPAs into three groups of apprioximately equal range. (Note: There are many ways to do this. See for example, https://www.rdocumentation.org/packages/ggplot2/versions/2.2.1/topics/cut_interval). 

15. Among the six groups represented by the GPA by sex interaction, which two groups are not observed in the data set?

16. Create a plot that explores this potential interaction. To do this, plot the mean response profile for each of the six groups defined in the sex by GPA interaction. Facet so that each profile is in its own panel.

17. Based on the plot, does the data suggest that there is an interaction between sex and GPA? Explain.


